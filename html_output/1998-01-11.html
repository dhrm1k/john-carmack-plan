<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1998-01-11</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preload" href="style.css" as="style">
</head>
<body>
    <nav class="nav">
        <a href="index.html" class="back-link">‚Üê Back to Index</a>
    </nav>
    <main class="content">
        <h1 class="page-title">1998-01-11</h1>
        <p>I AM GOING OUT OF TOWN NEXT WEEK, DON'T SEND ME ANY MAIL!</p>
<p>Odds are that I will get back and just flush the 500 messages in my mailbox.</p>
<p>No, I'm not taking a vacation. Quite the opposite, in fact.</p>
<p>I'm getting a hotel room in a state where I don't know anyone, so I can do a bunch of research with no distractions.</p>
<p>I bought a new computer specifically for this purpose - A Dolch portable pentium-II system. The significant thing is that it has full length PCI slots, so I was able to put an Evans &amp; Sutherland OpenGL accelerator in it (not enough room for an intergraph Realizm, though), and still drive the internal LCD screen. It works out pretty well, but I'm sure there will be conventional laptops with good 3D acceleration available later this year.</p>
<p>This will be an interesting experiment for me. I have always wondered how much of my time that isn't at peak productivity is a necessary rest break, and how much of it is just wasted.</p>
<hr />
<p>The client's IP address is now added to the userinfo before calling ClientConnect(), so any IP filtering / banning rules can now be implemented in the game dll. This will also give some of you crazy types the ability to sync up with multiple programs on the client computers outside of Q2 itself.</p>
<p>A new API entry point has been added to the game dll that gets called whenever an "sv" command is issued on the server console. This is to allow you to create commands for the server operator to type, as opposed to commands that a client would type (which are defined in g_cmds.c).</p>
<hr />
<p>We did a bunch of profiling today, and finaly got the information I wanted. We weren't doing anything brain dead stupid in the server, and all of the time was pretty much where I expected it to be.</p>
<p>I did found two things we can pursue for optimization.</p>
<p>A moderately expensive catagorization function is called at both the beginning and end of client movement simulation. With some care, we should be able to avoid the first one most of the time. That alone should be good for a &gt;10% server speedup.</p>
<p>The other major thing is that the client movement simulation accounted for 60% of the total execution time, and because it was already compartmentalized for client side prediction, it would not be much work to make it thread safe. Unfortunately, it would require MAJOR rework of the server code (and some of the game dll) to allow multiple client commands to run in parallel.</p>
<p>The potential is there to double the peak load that a server can carry if you have multiple processors. Note that you will definately get more players / system by just running multiple independent servers, rather than trying to get them all into a single large server.</p>
<p>We are not going to pursue either of these optimizations right now, but they will both be looked at again later.</p>
<p>All this optimizing of the single server is pushing the tail end of a paradigm. I expect trinity to be able to seamlessly hand off between clustered servers without the client even knowing it happened.</p>
    </main>
</body>
</html>